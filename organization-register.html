<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุชุณุฌูู ุฌูุฉ - ุณูุงุนุฏ</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--border-color);
        }
        
        .tab-btn {
            padding: 1rem;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            color: var(--text-light);
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .tab-btn.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .success-message {
            background-color: #d1fae5;
            color: #065f46;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="navbar">
            <div class="container">
                <div class="nav-content">
                    <div class="logo">
                        <img src="images/logo.png" alt="ุณูุงุนุฏ" style="height: 50px; width: auto;">
                    </div>
                    <ul class="nav-links">
                        <li><a href="index.html">ุงูุฑุฆูุณูุฉ</a></li>
                        <li><a href="about.html">ุนู ุณูุงุนุฏ</a></li>
                        <li><a href="opportunities.html">ูุฑุต ุงูุชุทูุน</a></li>
                        <li><a href="contact.html">ุชูุงุตู ูุนูุง</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="container">
        <div class="form-container">
            <h2>ููุตุฉ ุงูุฌูุงุช ุงูุชุทูุนูุฉ</h2>
            <p>ุณุฌู ุฌูุชู ูุฃุถู ูุฑุต ุงูุชุทูุน</p>
            
            <!-- Tabs -->
            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('register')">ุชุณุฌูู ุฌูุฉ ุฌุฏูุฏุฉ</button>
                <button class="tab-btn" onclick="switchTab('add-opportunity')">ุฅุถุงูุฉ ูุฑุตุฉ ุชุทูุน</button>
            </div>

            <!-- Tab 1: Register Organization -->
            <div id="register" class="tab-content active">
                <form id="organizationForm">
                    <div class="form-group">
                        <label for="orgName">ุงุณู ุงูุฌูุฉ *</label>
                        <input type="text" id="orgName" name="orgName" required>
                    </div>

                    <div class="form-group">
                        <label for="orgEmail">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู *</label>
                        <input type="email" id="orgEmail" name="orgEmail" required>
                    </div>

                    <div class="form-group">
                        <label for="orgPhone">ุฑูู ุงููุงุชู *</label>
                        <input type="tel" id="orgPhone" name="orgPhone" required>
                    </div>

                      <div class="form-group">
                    <label for="city">ุงููุฏููุฉ *</label>
                    <select id="city" name="city" required>
                        <option value="">ุงุฎุชุฑ ุงููุฏููุฉ</option>
                        <option value="ุงูุฑูุงุถ">ุงูุฑูุงุถ</option>
                         <option value="ุญุงูู">ุญุงุฆู</option>
                        <option value="ุงููุตูู">ุงููุตูู</option>
                        <option value="ุงุจูุง">ุงุจูุง</option>
                        <option value="ููู">ููู</option>
                        <option value="ุฌุฏุฉ">ุฌุฏุฉ</option>
                        <option value="ุงูุฏูุงู">ุงูุฏูุงู</option>
                        <option value="ุงูุฎุจุฑ">ุงูุฎุจุฑ</option>
                        <option value="ุงููุฏููู">ุงููุฏููู ุงููููุฑู</option>
                        <option value="ุชุจูู">ุชุจูู</option>
                        <option value="ุงุฎุฑู">ุงุฎุฑู</option>
                    </select>
                </div>

                    <div class="form-group">
                        <label for="orgType">ููุน ุงูุฌูุฉ *</label>
                        <select id="orgType" name="orgType" required>
                            <option value="">ุงุฎุชุฑ ุงูููุน</option>
                            <option value="ุฌูุนูุฉ ุฎูุฑูุฉ">ุฌูุนูุฉ ุฎูุฑูุฉ</option>
                            <option value="ูุคุณุณุฉ ุฃูููุฉ">ูุคุณุณุฉ ุฃูููุฉ</option>
                            <option value="ูุฑูุฒ ุชูููุฉ">ูุฑูุฒ ุชูููุฉ</option>
                            <option value="ุฌูุฉ ุญููููุฉ">ุฌูุฉ ุญููููุฉ</option>
                            <option value="ุดุฑูุฉ ุฎุงุตุฉ">ุดุฑูุฉ ุฎุงุตุฉ</option>
                            <option value="ูุฏุฑุณุฉ">ูุฏุฑุณุฉ</option>
                            <option value="ุฌุงูุนุฉ">ุฌุงูุนุฉ</option>
                            <option value="ูุณุชุดูู">ูุณุชุดูู</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="orgDescription">ูุตู ุงูุฌูุฉ *</label>
                        <textarea id="orgDescription" name="orgDescription" placeholder="ุงุดุฑุญ ูุดุงุท ุฌูุชู ูุงููุฌุงูุงุช ุงูุชู ุชุนูู ุจูุง" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="orgWebsite">ุงููููุน ุงูุฅููุชุฑููู</label>
                        <input type="url" id="orgWebsite" name="orgWebsite" placeholder="https://example.com">
                    </div>

                    <div class="form-buttons">
                        <button type="submit" class="btn btn-primary">ุชุณุฌูู</button>
                        <a href="index.html" class="btn btn-outline" style="background-color: #6b7280; border-color: #6b7280;">ุฅูุบุงุก</a>
                    </div>
                </form>
            </div>

            <!-- Tab 2: Add Opportunity -->
            <div id="add-opportunity" class="tab-content">
                <div id="org-info" style="display: none;">
                    <div class="success-message">
                        <p>ูุฑุญุจุงู ุจู <strong id="org-name-display"></strong>! ููููู ุงูุขู ุฅุถุงูุฉ ูุฑุต ุงูุชุทูุน</p>
                    </div>
                </div>

                <form id="opportunityForm">
                    <input type="hidden" id="orgId" value="">

                    <div class="form-group">
                        <label for="title">ุนููุงู ุงููุฑุตุฉ *</label>
                        <input type="text" id="title" name="title" placeholder="ูุซุงู: ูุณุงุนุฏ ุชุฏุฑูุณ" required>
                    </div>

                    <div class="form-group">
                        <label for="field">ุงููุฌุงู *</label>
                        <select id="field" name="field" required>
                            <option value="">ุงุฎุชุฑ ุงููุฌุงู</option>
                            <option value="ุงูุชุนููู">ุงูุชุนููู</option>
                            <option value="ุงูุตุญุฉ">ุงูุตุญุฉ</option>
                            <option value="ุงูุจูุฆุฉ">ุงูุจูุฆุฉ</option>
                            <option value="ุงููุฌุชูุน">ุงููุฌุชูุน</option>
                            <option value="ุงูุฑูุงุถุฉ">ุงูุฑูุงุถุฉ</option>
                            <option value="ุงูุซูุงูุฉ">ุงูุซูุงูุฉ</option>
                            <option value="ุงูุชูููููุฌูุง">ุงูุชูููููุฌูุง</option>
                            <option value="ุฃุฎุฑู">ุฃุฎุฑู</option>
                        </select>
                    </div>

                     <div class="form-group">
                    <label for="city">ุงููุฏููุฉ *</label>
                    <select id="city" name="city" required>
                        <option value="">ุงุฎุชุฑ ุงููุฏููุฉ</option>
                        <option value="ุงูุฑูุงุถ">ุงูุฑูุงุถ</option>
                         <option value="ุญุงูู">ุญุงุฆู</option>
                        <option value="ุงููุตูู">ุงููุตูู</option>
                        <option value="ุงุจูุง">ุงุจูุง</option>
                        <option value="ููู">ููู</option>
                        <option value="ุฌุฏุฉ">ุฌุฏุฉ</option>
                        <option value="ุงูุฏูุงู">ุงูุฏูุงู</option>
                        <option value="ุงูุฎุจุฑ">ุงูุฎุจุฑ</option>
                        <option value="ุงููุฏููู">ุงููุฏููู ุงููููุฑู</option>
                        <option value="ุชุจูู">ุชุจูู</option>
                        <option value="ุงุฎุฑู">ุงุฎุฑู</option>
                    </select>
                </div>

                    <div class="form-group">
                        <label for="description">ูุตู ุงููุฑุตุฉ *</label>
                        <textarea id="description" name="description" placeholder="ุงุดุฑุญ ุชูุงุตูู ุงููุฑุตุฉ ูุงูููุงู ุงููุทููุจุฉ" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="volunteersNeeded">ุนุฏุฏ ุงููุชุทูุนูู ุงููุทููุจูู *</label>
                        <input type="number" id="volunteersNeeded" name="volunteersNeeded" min="1" required>
                    </div>

                    <div class="form-group">
                        <label for="requirements">ุงููุชุทูุจุงุช *</label>
                        <textarea id="requirements" name="requirements" placeholder="ุงูููุงุฑุงุช ูุงูุฎุจุฑุงุช ุงููุทููุจุฉ" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="startDate">ุชุงุฑูุฎ ุงูุจุฏุงูุฉ *</label>
                        <input type="date" id="startDate" name="startDate" required>
                    </div>

                    <div class="form-group">
                        <label for="endDate">ุชุงุฑูุฎ ุงูููุงูุฉ *</label>
                        <input type="date" id="endDate" name="endDate" required>
                    </div>

                    <div class="form-buttons">
                        <button type="submit" class="btn btn-primary">ุฅุถุงูุฉ ุงููุฑุตุฉ</button>
                        <button type="reset" class="btn btn-outline" style="background-color: #6b7280; border-color: #6b7280;">ูุณุญ</button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>ุณูุงุนุฏ</h4>
                    <p>ููุตุฉ ุชุฑุจุท ุงููุชุทูุนูู ุจุงูุฌูุงุช ุงูุชู ุชุญุชุงุฌ ุฅูู ูุชุทูุนูู</p>
                </div>
                <div class="footer-section">
                    <h4>ุฑูุงุจุท ุณุฑูุนุฉ</h4>
                    <ul>
                        <li><a href="about.html">ุนู ุณูุงุนุฏ</a></li>
                        <li><a href="opportunities.html">ูุฑุต ุงูุชุทูุน</a></li>
                        <li><a href="contact.html">ุชูุงุตู ูุนูุง</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>ุชูุงุตู ูุนูุง</h4>
                    <p>ูุณุนุฏ ุจุชูุงุตููู ูุนูุง ูู ุฃู ููุช</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>ยฉ 2025 ุณูุงุนุฏ. ุฌููุน ุงูุญููู ูุญููุธุฉ.</p>
            </div>
        </div>
    </footer>

    <script src="js/main.js"></script>
    <script>
        // Switch between tabs
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }

        // Handle organization form submission
        document.getElementById('organizationForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = {
                name: document.getElementById('orgName').value,
                email: document.getElementById('orgEmail').value,
                phone: document.getElementById('orgPhone').value,
                city: document.getElementById('orgCity').value,
                type: document.getElementById('orgType').value,
                description: document.getElementById('orgDescription').value,
                website: document.getElementById('orgWebsite').value || null
            };
            
            console.log('๐ค Submitting organization form:', formData);
            
            try {
                const response = await fetch('http://localhost:3000/api/organizations', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    // Save organization ID to localStorage
                    localStorage.setItem('orgId', data.id);
                    localStorage.setItem('orgName', formData.name);
                    
                    // Show success message
                    showMessage('ุชู ุงูุชุณุฌูู ุจูุฌุงุญ! ุงูุขู ููููู ุฅุถุงูุฉ ูุฑุต ุงูุชุทูุน', 'success');
                    
                    // Update add-opportunity tab
                    document.getElementById('org-info').style.display = 'block';
                    document.getElementById('org-name-display').textContent = formData.name;
                    document.getElementById('orgId').value = data.id;
                    
                    // Switch to add-opportunity tab
                    setTimeout(() => {
                        document.querySelector('[onclick="switchTab(\'add-opportunity\')"]').click();
                    }, 1500);
                } else {
                    showMessage(data.error || 'ุญุฏุซ ุฎุทุฃ ูู ุงูุชุณุฌูู', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage('ุฎุทุฃ ูู ุงูุงุชุตุงู ุจุงูุฎุงุฏู: ' + error.message, 'error');
            }
        });

        // Handle opportunity form submission
        document.getElementById('opportunityForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const orgId = localStorage.getItem('orgId') || document.getElementById('orgId').value;
            
            if (!orgId) {
                showMessage('ูุฑุฌู ุชุณุฌูู ุฌูุชู ุฃููุงู', 'error');
                return;
            }
            
            const formData = {
                organizationId: parseInt(orgId),
                title: document.getElementById('title').value,
                field: document.getElementById('field').value,
                city: document.getElementById('city').value,
                description: document.getElementById('description').value,
                volunteersNeeded: parseInt(document.getElementById('volunteersNeeded').value),
                requirements: document.getElementById('requirements').value,
                startDate: document.getElementById('startDate').value,
                endDate: document.getElementById('endDate').value,
                status: 'active'
            };
            
            console.log('๐ค Submitting opportunity form:', formData);
            
            try {
                const response = await fetch('http://localhost:3000/api/opportunities', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showMessage('ุชู ุฅุถุงูุฉ ุงููุฑุตุฉ ุจูุฌุงุญ! ุณูุชู ูููู ูุตูุญุฉ ุงููุฑุต...', 'success');
                    document.getElementById('opportunityForm').reset();
                    
                    // Redirect to opportunities page after 2 seconds
                    setTimeout(() => {
                        window.location.href = 'opportunities.html';
                    }, 2000);
                } else {
                    showMessage(data.error || 'ุญุฏุซ ุฎุทุฃ ูู ุฅุถุงูุฉ ุงููุฑุตุฉ', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage('ุฎุทุฃ ูู ุงูุงุชุตุงู ุจุงูุฎุงุฏู: ' + error.message, 'error');
            }
        });

        // Load saved organization data if exists
        window.addEventListener('load', () => {
            const savedOrgId = localStorage.getItem('orgId');
            const savedOrgName = localStorage.getItem('orgName');
            
            if (savedOrgId && savedOrgName) {
                document.getElementById('org-info').style.display = 'block';
                document.getElementById('org-name-display').textContent = savedOrgName;
                document.getElementById('orgId').value = savedOrgId;
            }
        });
    </script>
</body>
</html>